{
  "version": 1,
  "defaults": {
    "mode_to_template": {
      "core": "core",
      "archive": "archive",
      "custom": "core"
    },
    "notes": [
      "规则按顺序匹配：第一条命中即生效（first-match-wins）。",
      "match 使用 glob（相对项目根目录），示例：src/**/*.py。",
      "mode 支持：full | interface | head | skip。",
      "head 模式默认导出前 head_lines 行。",
      "interface 仅对 .py 做 AST 接口提取；其他文件降级为 head。",
      "archive 模板默认会额外生成 zip 归档（make_zip=true）。"
    ]
  },
  "templates": {
    "core": {
      "desc": "LLM-friendly snapshot：核心业务代码完整 + 非核心接口/头部，包含项目全貌与进度。",
      "output": "project_context.txt",
      "redact": true,
      "include_reports": true,
      "max_file_bytes": 200000,
      "max_total_bytes": 1500000,
      "tree": {"max_depth": 8, "max_entries_per_dir": 250},
      "include_globs": [
        "README.md",
        "PROJECT_STATUS.json",
        ".gitignore",
        "conf/**/*.ini",
        "src/**/*.py",
        "devtools/**/*.py",
        "tests/**/*.py",
        "bin/**",
        "data/reports/**/*.md",
        "data/samples/**/*"
      ],
      "ignore_files": [
        "project_context.txt",
        ".DS_Store",
        "id_rsa",
        "id_ed25519",
        "known_hosts"
      ],
      "ignore_globs": [
        "data/snapshots/**",
        "**/*.swp",
        "**/*.swo",
        "**/*.tmp",
        "**/*.bak",
        "**/*.log",
        "**/*.zip",
        "**/*.tar",
        "**/*.tar.gz",
        "**/*.gz",
        "**/*.7z",
        "**/*.rar",
        "**/*.png",
        "**/*.jpg",
        "**/*.jpeg",
        "**/*.webp",
        "**/*.pdf",
        "**/*.mp4",
        "**/*.mov",
        "**/*.sqlite",
        "**/*.db",
        "**/.env",
        "**/.env.*",
        "**/*.pem",
        "**/*.key"
      ],
      "rules": [
        {"match": "devtools/snapshot.py", "mode": "full"},
        {"match": "src/engine.py", "mode": "full"},
        {"match": "src/analyzer.py", "mode": "full"},
        {"match": "src/explorer.py", "mode": "full"},
        {"match": "src/wiki.py", "mode": "full"},
        {"match": "src/registry.py", "mode": "full"},
        {"match": "src/**/*.py", "mode": "full"},
        {"match": "devtools/**/*.py", "mode": "interface"},
        {"match": "tests/**/*.py", "mode": "head", "head_lines": 220},
        {"match": "bin/**", "mode": "head", "head_lines": 160},
        {"match": "conf/**", "mode": "full"},
        {"match": "data/reports/**/*.md", "mode": "head", "head_lines": 260},
        {"match": "data/samples/**/*.md", "mode": "head", "head_lines": 340},
        {"match": "data/samples/**/*.json", "mode": "head", "head_lines": 160},
        {"match": "*.md", "mode": "head", "head_lines": 240},
        {"match": "*.txt", "mode": "head", "head_lines": 240},
        {"match": "**/*", "mode": "skip"}
      ]
    },

    "archive": {
      "desc": "Archival snapshot：尽量完整导出 + 生成 zip 归档（适合长期留存/回溯）。",
      "output": "data/snapshots/archive_{timestamp}.md",
      "make_zip": true,
      "zip_output": "data/snapshots/archive_{timestamp}.zip",
      "redact": true,
      "include_reports": true,
      "max_file_bytes": 500000,
      "max_total_bytes": 20000000,
      "tree": {"max_depth": 30, "max_entries_per_dir": 1000},
      "include_globs": ["**/*"],
      "ignore_files": [
        "project_context.txt",
        ".DS_Store",
        "id_rsa",
        "id_ed25519",
        "known_hosts"
      ],
      "ignore_globs": [
        "data/snapshots/**",
        "**/*.swp",
        "**/*.swo",
        "**/*.tmp",
        "**/*.bak",
        "**/*.log",
        "**/*.zip",
        "**/*.tar",
        "**/*.tar.gz",
        "**/*.gz",
        "**/*.7z",
        "**/*.rar",
        "**/*.png",
        "**/*.jpg",
        "**/*.jpeg",
        "**/*.webp",
        "**/*.pdf",
        "**/*.mp4",
        "**/*.mov",
        "**/*.sqlite",
        "**/*.db",
        "**/.env",
        "**/.env.*",
        "**/*.pem",
        "**/*.key"
      ],
      "rules": [
        {"match": "**/*", "mode": "full"}
      ]
    },

    "focus_analyzer": {
      "desc": "聚焦：增强 analyzer 对更多 DST 数据类型的解析，并同步到 explorer/wiki。",
      "output": "project_context.focus_analyzer.txt",
      "redact": true,
      "include_reports": true,
      "max_file_bytes": 260000,
      "max_total_bytes": 2200000,
      "tree": {"max_depth": 10, "max_entries_per_dir": 300},
      "include_globs": [
        "PROJECT_STATUS.json",
        "README.md",
        "conf/**/*.ini",
        "src/**/*.py",
        "tests/**/*.py",
        "devtools/**/*.py",
        "data/reports/**/*.md",
        "data/samples/**/*"
      ],
      "ignore_files": [
        "project_context.txt",
        ".DS_Store",
        "id_rsa",
        "id_ed25519",
        "known_hosts"
      ],
      "ignore_globs": [
        "data/snapshots/**",
        "**/*.swp",
        "**/*.swo",
        "**/*.tmp",
        "**/*.bak",
        "**/*.log",
        "**/*.zip",
        "**/*.tar",
        "**/*.tar.gz",
        "**/*.gz",
        "**/*.7z",
        "**/*.rar",
        "**/*.png",
        "**/*.jpg",
        "**/*.jpeg",
        "**/*.webp",
        "**/*.pdf",
        "**/*.mp4",
        "**/*.mov",
        "**/*.sqlite",
        "**/*.db",
        "**/.env",
        "**/.env.*",
        "**/*.pem",
        "**/*.key"
      ],
      "rules": [
        {"match": "src/analyzer.py", "mode": "full"},
        {"match": "src/engine.py", "mode": "full"},
        {"match": "src/explorer.py", "mode": "full"},
        {"match": "src/wiki.py", "mode": "full"},
        {"match": "src/utils.py", "mode": "full"},
        {"match": "src/registry.py", "mode": "full"},
        {"match": "tests/**/*.py", "mode": "full"},
        {"match": "devtools/sampler.py", "mode": "full"},
        {"match": "devtools/codemap.py", "mode": "full"},
        {"match": "devtools/reporter.py", "mode": "interface"},
        {"match": "devtools/snapshot.py", "mode": "interface"},
        {"match": "devtools/**/*.py", "mode": "interface"},
        {"match": "conf/**", "mode": "full"},
        {"match": "data/reports/**/*.md", "mode": "full"},
        {"match": "data/samples/**/*.md", "mode": "head", "head_lines": 420},
        {"match": "data/samples/**/*.json", "mode": "head", "head_lines": 220},
        {"match": "bin/**", "mode": "skip"},
        {"match": "**/*", "mode": "skip"}
      ]
    }
  }
}
